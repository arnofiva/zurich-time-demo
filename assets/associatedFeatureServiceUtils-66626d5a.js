import{aA as t,dZ as L,av as s,dU as f,dV as T,aw as m,ax as y,gx as D}from"./index-5b8adf8e.js";const R={BingMapsLayer:async()=>(await t(()=>import("./BingMapsLayer-dffe3146.js"),["./BingMapsLayer-dffe3146.js","./index-5b8adf8e.js","./index-fa8fa232.css","./imageBitmapUtils-720ac7a1.js"],import.meta.url)).default,BuildingSceneLayer:async()=>(await t(()=>import("./BuildingSceneLayer-374f3e1d.js"),["./BuildingSceneLayer-374f3e1d.js","./index-5b8adf8e.js","./index-fa8fa232.css","./BuildingComponentSublayer-2fc50d4e.js","./FeatureLayer-f16366de.js","./FeatureLayerBase-e07f2f14.js","./LayerFloorInfo-b494a401.js","./serviceCapabilitiesUtils-3ac061d0.js","./editsZScale-e3d24fbf.js","./queryZScale-c917a291.js","./FeatureSet-04b2b8c3.js","./APIKeyMixin-90b32f33.js","./EditBusLayer-b09fc428.js","./OrderedLayer-8532bad2.js","./FeatureTemplate-b7e0da9d.js","./FeatureType-a8ae05f2.js","./versionUtils-202bc3bf.js","./TopFeaturesQuery-a462936c.js","./capabilities-c607cf72.js","./I3SIndexInfo-0d434efc.js","./I3SLayerDefinitions-8c8c6e62.js","./I3SUtil-d618388d.js","./I3SBinaryReader-5797a2b6.js","./popupUtils-60af7d20.js","./BuildingGroupSublayer-a4a5a61f.js","./SceneService-4e3fb79d.js","./elevationInfoUtils-cc8c21bf.js"],import.meta.url)).default,CSVLayer:async()=>(await t(()=>import("./CSVLayer-8ecf26be.js"),["./CSVLayer-8ecf26be.js","./index-5b8adf8e.js","./index-fa8fa232.css","./FeatureLayer-f16366de.js","./FeatureLayerBase-e07f2f14.js","./LayerFloorInfo-b494a401.js","./serviceCapabilitiesUtils-3ac061d0.js","./editsZScale-e3d24fbf.js","./queryZScale-c917a291.js","./FeatureSet-04b2b8c3.js","./APIKeyMixin-90b32f33.js","./EditBusLayer-b09fc428.js","./OrderedLayer-8532bad2.js","./FeatureTemplate-b7e0da9d.js","./FeatureType-a8ae05f2.js","./versionUtils-202bc3bf.js","./TopFeaturesQuery-a462936c.js","./clientSideDefaults-5ac88bfc.js","./QueryEngineCapabilities-85c4f1d0.js"],import.meta.url)).default,DimensionLayer:async()=>(await t(()=>import("./DimensionLayer-3002e22f.js"),["./DimensionLayer-3002e22f.js","./index-5b8adf8e.js","./index-fa8fa232.css","./Analysis-dcdf70da.js","./LengthDimension-a90dda75.js"],import.meta.url)).default,ElevationLayer:async()=>(await t(()=>import("./ElevationLayer-d776a33b.js"),["./ElevationLayer-d776a33b.js","./index-5b8adf8e.js","./index-fa8fa232.css","./ArcGISCachedService-9b0e36bb.js","./TileInfoTilemapCache-92a4c169.js","./TilemapCache-97433388.js"],import.meta.url)).default,FeatureLayer:async()=>(await t(()=>import("./FeatureLayer-f16366de.js"),["./FeatureLayer-f16366de.js","./index-5b8adf8e.js","./index-fa8fa232.css","./FeatureLayerBase-e07f2f14.js","./LayerFloorInfo-b494a401.js","./serviceCapabilitiesUtils-3ac061d0.js","./editsZScale-e3d24fbf.js","./queryZScale-c917a291.js","./FeatureSet-04b2b8c3.js","./APIKeyMixin-90b32f33.js","./EditBusLayer-b09fc428.js","./OrderedLayer-8532bad2.js","./FeatureTemplate-b7e0da9d.js","./FeatureType-a8ae05f2.js","./versionUtils-202bc3bf.js","./TopFeaturesQuery-a462936c.js"],import.meta.url)).default,GeoJSONLayer:async()=>(await t(()=>import("./GeoJSONLayer-154dae4d.js"),["./GeoJSONLayer-154dae4d.js","./index-5b8adf8e.js","./index-fa8fa232.css","./clientSideDefaults-5ac88bfc.js","./QueryEngineCapabilities-85c4f1d0.js","./FeatureSet-04b2b8c3.js","./OrderedLayer-8532bad2.js","./FeatureTemplate-b7e0da9d.js","./FeatureType-a8ae05f2.js"],import.meta.url)).default,GeoRSSLayer:async()=>(await t(()=>import("./GeoRSSLayer-8a2125dd.js"),["./GeoRSSLayer-8a2125dd.js","./index-5b8adf8e.js","./index-fa8fa232.css"],import.meta.url)).default,GroupLayer:async()=>(await t(()=>import("./GroupLayer-553fb80a.js"),["./GroupLayer-553fb80a.js","./index-5b8adf8e.js","./index-fa8fa232.css"],import.meta.url)).default,ImageryLayer:async()=>(await t(()=>import("./ImageryLayer-c6a30876.js"),["./ImageryLayer-c6a30876.js","./index-5b8adf8e.js","./index-fa8fa232.css","./ImageHistogramParameters-434f8492.js","./dataUtils-31647771.js","./pixelRangeUtils-367cd051.js","./generateRendererUtils-31a90f14.js","./FeatureSet-04b2b8c3.js","./imageBitmapUtils-720ac7a1.js","./executeQueryJSON-84114af1.js","./query-beb65f31.js","./pbfQueryUtils-5298f41b.js","./pbf-16e0ae52.js","./queryZScale-c917a291.js","./AttachmentInfo-f5d4991f.js","./executeForIds-862d8357.js","./TopFeaturesQuery-a462936c.js","./versionUtils-202bc3bf.js"],import.meta.url)).default,ImageryTileLayer:async()=>(await t(()=>import("./ImageryTileLayer-3d2b09e0.js"),["./ImageryTileLayer-3d2b09e0.js","./index-5b8adf8e.js","./index-fa8fa232.css","./ImageHistogramParameters-434f8492.js","./dataUtils-31647771.js","./pixelRangeUtils-367cd051.js","./generateRendererUtils-31a90f14.js","./FeatureSet-04b2b8c3.js","./rasterProjectionHelper-4c069f36.js","./utils-3acb0c74.js","./TilemapCache-97433388.js"],import.meta.url)).default,IntegratedMeshLayer:async()=>(await t(()=>import("./IntegratedMeshLayer-c057869d.js"),["./IntegratedMeshLayer-c057869d.js","./index-5b8adf8e.js","./index-fa8fa232.css","./persistable-cec6d2e4.js","./resourceExtension-5b2d5f5b.js","./APIKeyMixin-90b32f33.js","./SceneService-4e3fb79d.js","./I3SIndexInfo-0d434efc.js","./I3SLayerDefinitions-8c8c6e62.js","./SceneModification-483e1176.js","./elevationInfoUtils-cc8c21bf.js"],import.meta.url)).default,KMLLayer:async()=>(await t(()=>import("./KMLLayer-39bc7c20.js"),["./KMLLayer-39bc7c20.js","./index-5b8adf8e.js","./index-fa8fa232.css","./FeatureSet-04b2b8c3.js"],import.meta.url)).default,LineOfSightLayer:async()=>(await t(()=>import("./LineOfSightLayer-6bf51c52.js"),["./LineOfSightLayer-6bf51c52.js","./index-5b8adf8e.js","./index-fa8fa232.css","./Analysis-dcdf70da.js","./LineOfSightAnalysisTarget-67927292.js","./persistable-cec6d2e4.js","./resourceExtension-5b2d5f5b.js","./elevationInfoUtils-cc8c21bf.js"],import.meta.url)).default,LinkChartLayer:async()=>(await t(()=>import("./LinkChartLayer-004ae4ba.js"),["./LinkChartLayer-004ae4ba.js","./index-5b8adf8e.js","./index-fa8fa232.css","./geohashUtils-77d8429b.js","./FeatureStore-3bd3d828.js","./BoundsStore-6b3fb195.js","./PooledRBush-a0d2032b.js","./quickselect-875de149.js","./QueryEngine-c0c55c1f.js","./WhereClause-11a7e4df.js","./TimeOnly-99395aba.js","./json-48e3ea08.js","./QueryEngineCapabilities-85c4f1d0.js","./utils-2f164960.js","./utils-40d3b03c.js","./generateRendererUtils-31a90f14.js","./optimizedFeatureQueryEngineAdapter-fab01f44.js","./clientSideDefaults-5ac88bfc.js","./FeatureSet-04b2b8c3.js"],import.meta.url)).default,MapImageLayer:async()=>(await t(()=>import("./MapImageLayer-3e5752e1.js"),["./MapImageLayer-3e5752e1.js","./index-5b8adf8e.js","./index-fa8fa232.css","./APIKeyMixin-90b32f33.js","./SublayersOwner-90c366fb.js","./QueryTask-73ea0ad4.js","./executeForIds-862d8357.js","./query-beb65f31.js","./pbfQueryUtils-5298f41b.js","./pbf-16e0ae52.js","./queryZScale-c917a291.js","./executeQueryJSON-84114af1.js","./FeatureSet-04b2b8c3.js","./executeQueryPBF-dfb39e95.js","./FeatureType-a8ae05f2.js","./FeatureTemplate-b7e0da9d.js","./LayerFloorInfo-b494a401.js","./serviceCapabilitiesUtils-3ac061d0.js","./sublayerUtils-2efc0ddd.js","./ExportImageParameters-3fda196e.js","./floorFilterUtils-73949d2d.js","./imageBitmapUtils-720ac7a1.js","./versionUtils-202bc3bf.js"],import.meta.url)).default,MapNotesLayer:async()=>(await t(()=>import("./MapNotesLayer-b096b065.js"),["./MapNotesLayer-b096b065.js","./index-5b8adf8e.js","./index-fa8fa232.css","./FeatureLayer-f16366de.js","./FeatureLayerBase-e07f2f14.js","./LayerFloorInfo-b494a401.js","./serviceCapabilitiesUtils-3ac061d0.js","./editsZScale-e3d24fbf.js","./queryZScale-c917a291.js","./FeatureSet-04b2b8c3.js","./APIKeyMixin-90b32f33.js","./EditBusLayer-b09fc428.js","./OrderedLayer-8532bad2.js","./FeatureTemplate-b7e0da9d.js","./FeatureType-a8ae05f2.js","./versionUtils-202bc3bf.js","./TopFeaturesQuery-a462936c.js","./objectIdUtils-967fafff.js"],import.meta.url)).default,MediaLayer:async()=>(await t(()=>import("./MediaLayer-b01c55e1.js"),["./MediaLayer-b01c55e1.js","./index-5b8adf8e.js","./index-fa8fa232.css","./MediaElementView-8f8af106.js","./normalizeUtilsSync-69abb8b5.js","./resourceExtension-5b2d5f5b.js","./BoundsStore-6b3fb195.js","./PooledRBush-a0d2032b.js","./quickselect-875de149.js"],import.meta.url)).default,OGCFeatureLayer:async()=>(await t(()=>import("./OGCFeatureLayer-afe383cf.js"),["./OGCFeatureLayer-afe383cf.js","./index-5b8adf8e.js","./index-fa8fa232.css","./ogcFeatureUtils-8ce2d9c3.js","./geojson-c2c73765.js","./date-430969b3.js","./clientSideDefaults-5ac88bfc.js","./QueryEngineCapabilities-85c4f1d0.js","./FeatureSet-04b2b8c3.js","./APIKeyMixin-90b32f33.js","./OrderedLayer-8532bad2.js","./FeatureType-a8ae05f2.js","./FeatureTemplate-b7e0da9d.js"],import.meta.url)).default,OpenStreetMapLayer:async()=>(await t(()=>import("./OpenStreetMapLayer-3c431aaa.js"),["./OpenStreetMapLayer-3c431aaa.js","./index-5b8adf8e.js","./index-fa8fa232.css","./WebTileLayer-f073bd56.js","./imageBitmapUtils-720ac7a1.js"],import.meta.url)).default,OrientedImageryLayer:async()=>(await t(()=>import("./OrientedImageryLayer-2c7c755b.js"),["./OrientedImageryLayer-2c7c755b.js","./index-5b8adf8e.js","./index-fa8fa232.css","./FeatureLayer-f16366de.js","./FeatureLayerBase-e07f2f14.js","./LayerFloorInfo-b494a401.js","./serviceCapabilitiesUtils-3ac061d0.js","./editsZScale-e3d24fbf.js","./queryZScale-c917a291.js","./FeatureSet-04b2b8c3.js","./APIKeyMixin-90b32f33.js","./EditBusLayer-b09fc428.js","./OrderedLayer-8532bad2.js","./FeatureTemplate-b7e0da9d.js","./FeatureType-a8ae05f2.js","./versionUtils-202bc3bf.js","./TopFeaturesQuery-a462936c.js"],import.meta.url)).default,PointCloudLayer:async()=>(await t(()=>import("./PointCloudLayer-6f8a8586.js"),["./PointCloudLayer-6f8a8586.js","./index-5b8adf8e.js","./index-fa8fa232.css","./APIKeyMixin-90b32f33.js","./SceneService-4e3fb79d.js","./I3SIndexInfo-0d434efc.js","./PointCloudUniqueValueRenderer-ba9e5cd8.js","./elevationInfoUtils-cc8c21bf.js"],import.meta.url)).default,RouteLayer:async()=>(await t(()=>import("./RouteLayer-117c3823.js"),["./RouteLayer-117c3823.js","./index-5b8adf8e.js","./index-fa8fa232.css","./Stop-e5801a24.js","./FeatureSet-04b2b8c3.js"],import.meta.url)).default,SceneLayer:async()=>(await t(()=>import("./SceneLayer-c5760a40.js"),["./SceneLayer-c5760a40.js","./index-5b8adf8e.js","./index-fa8fa232.css","./APIKeyMixin-90b32f33.js","./EditBusLayer-b09fc428.js","./SceneService-4e3fb79d.js","./I3SIndexInfo-0d434efc.js","./capabilities-c607cf72.js","./I3SLayerDefinitions-8c8c6e62.js","./LayerFloorInfo-b494a401.js","./persistable-cec6d2e4.js","./resourceExtension-5b2d5f5b.js","./elevationInfoUtils-cc8c21bf.js","./I3SUtil-d618388d.js","./I3SBinaryReader-5797a2b6.js","./popupUtils-60af7d20.js"],import.meta.url)).default,StreamLayer:async()=>(await t(()=>import("./index-5b8adf8e.js").then(e=>e.y8),["./index-5b8adf8e.js","./index-fa8fa232.css"],import.meta.url)).default,SubtypeGroupLayer:async()=>(await t(()=>import("./SubtypeGroupLayer-dd4f07ff.js"),["./SubtypeGroupLayer-dd4f07ff.js","./index-5b8adf8e.js","./index-fa8fa232.css","./APIKeyMixin-90b32f33.js","./EditBusLayer-b09fc428.js","./FeatureLayerBase-e07f2f14.js","./LayerFloorInfo-b494a401.js","./serviceCapabilitiesUtils-3ac061d0.js","./FeatureTemplate-b7e0da9d.js","./versionUtils-202bc3bf.js"],import.meta.url)).default,TileLayer:async()=>(await t(()=>import("./TileLayer-014aafb2.js"),["./TileLayer-014aafb2.js","./index-5b8adf8e.js","./index-fa8fa232.css","./APIKeyMixin-90b32f33.js","./ArcGISCachedService-9b0e36bb.js","./TileInfoTilemapCache-92a4c169.js","./TilemapCache-97433388.js","./SublayersOwner-90c366fb.js","./QueryTask-73ea0ad4.js","./executeForIds-862d8357.js","./query-beb65f31.js","./pbfQueryUtils-5298f41b.js","./pbf-16e0ae52.js","./queryZScale-c917a291.js","./executeQueryJSON-84114af1.js","./FeatureSet-04b2b8c3.js","./executeQueryPBF-dfb39e95.js","./FeatureType-a8ae05f2.js","./FeatureTemplate-b7e0da9d.js","./LayerFloorInfo-b494a401.js","./serviceCapabilitiesUtils-3ac061d0.js","./sublayerUtils-2efc0ddd.js","./imageBitmapUtils-720ac7a1.js"],import.meta.url)).default,UnknownLayer:async()=>(await t(()=>import("./UnknownLayer-bf1bd4f7.js"),["./UnknownLayer-bf1bd4f7.js","./index-5b8adf8e.js","./index-fa8fa232.css"],import.meta.url)).default,UnsupportedLayer:async()=>(await t(()=>import("./UnsupportedLayer-72ffb6db.js"),["./UnsupportedLayer-72ffb6db.js","./index-5b8adf8e.js","./index-fa8fa232.css"],import.meta.url)).default,VectorTileLayer:async()=>(await t(()=>import("./VectorTileLayer-b9662441.js"),["./VectorTileLayer-b9662441.js","./index-5b8adf8e.js","./index-fa8fa232.css","./APIKeyMixin-90b32f33.js","./ArcGISCachedService-9b0e36bb.js","./TileInfoTilemapCache-92a4c169.js","./TilemapCache-97433388.js","./jsonContext-2b28d6d2.js","./StyleRepository-eb0639a5.js","./TileClipper-ae6eca9e.js","./definitions-41f74ea6.js"],import.meta.url)).default,VoxelLayer:async()=>(await t(()=>import("./VoxelLayer-a3c647c3.js"),["./VoxelLayer-a3c647c3.js","./index-5b8adf8e.js","./index-fa8fa232.css","./APIKeyMixin-90b32f33.js","./SceneService-4e3fb79d.js","./I3SIndexInfo-0d434efc.js","./persistable-cec6d2e4.js","./resourceExtension-5b2d5f5b.js"],import.meta.url)).default,WFSLayer:async()=>(await t(()=>import("./WFSLayer-666583a2.js"),["./WFSLayer-666583a2.js","./index-5b8adf8e.js","./index-fa8fa232.css","./clientSideDefaults-5ac88bfc.js","./QueryEngineCapabilities-85c4f1d0.js","./wfsUtils-21cf2f8f.js","./geojson-c2c73765.js","./date-430969b3.js","./xmlUtils-444cb4c0.js","./FeatureSet-04b2b8c3.js","./OrderedLayer-8532bad2.js"],import.meta.url)).default,WMSLayer:async()=>(await t(()=>import("./WMSLayer-a134d944.js"),["./WMSLayer-a134d944.js","./index-5b8adf8e.js","./index-fa8fa232.css","./crsUtils-3bab3d8c.js","./ExportWMSImageParameters-6ff5d0ee.js","./imageBitmapUtils-720ac7a1.js"],import.meta.url)).default,WMTSLayer:async()=>(await t(()=>import("./WMTSLayer-0701aeb9.js"),["./WMTSLayer-0701aeb9.js","./index-5b8adf8e.js","./index-fa8fa232.css","./WebTileLayer-f073bd56.js","./imageBitmapUtils-720ac7a1.js","./TileInfoTilemapCache-92a4c169.js","./crsUtils-3bab3d8c.js","./xmlUtils-444cb4c0.js"],import.meta.url)).default,WebTileLayer:async()=>(await t(()=>import("./WebTileLayer-f073bd56.js").then(e=>e.W),["./WebTileLayer-f073bd56.js","./index-5b8adf8e.js","./index-fa8fa232.css","./imageBitmapUtils-720ac7a1.js"],import.meta.url)).default};async function S(e,i){const r=L(e);if(!r)throw new s("invalid-url","Invalid scene service url");const a={...i,sceneServerUrl:r.url.path,layerId:r.sublayer??void 0};if(a.sceneLayerItem??(a.sceneLayerItem=await A(a)),a.sceneLayerItem==null)return p(a.sceneServerUrl.replace("/SceneServer","/FeatureServer"),a);const o=await V(a);if(!o?.url)throw new s("related-service-not-found","Could not find feature service through portal item relationship");const _=await p(o.url,a);return _.portalItem=o,_}async function A(e){const i=(await E(e)).serviceItemId;if(!i)return null;const r=new f({id:i,apiKey:e.apiKey}),a=await O(e);a!=null&&(r.portal=new T({url:a}));try{return r.load({signal:e.signal})}catch(o){return m(o),null}}async function E(e){if(e.rootDocument)return e.rootDocument;const i={query:{f:"json",token:e.apiKey},responseType:"json",signal:e.signal};try{const r=await y(e.sceneServerUrl,i);e.rootDocument=r.data}catch{e.rootDocument={}}return e.rootDocument}async function O(e){const i=D?.findServerInfo(e.sceneServerUrl);if(i?.owningSystemUrl)return i.owningSystemUrl;const r=e.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const a=(await y(r,{query:{f:"json"},responseType:"json",signal:e.signal})).data.owningSystemUrl;if(a)return a}catch(a){m(a)}return null}async function p(e,i){const r=L(e);if(!r)throw new s("invalid-feature-service-url","Invalid feature service url");const a=r.url.path,o=i.layerId;if(o==null)return{serverUrl:a};const _=E(i),d=n=>{const I={query:{f:"json"},responseType:"json",authMode:n,signal:i.signal};return y(a,I)},v=d("anonymous").catch(()=>d("no-prompt")),[c,w]=await Promise.all([v,_]),l=w?.layers,u=c.data&&c.data.layers;if(!Array.isArray(u))throw new Error("expected layers array");if(Array.isArray(l)){for(let n=0;n<Math.min(l.length,u.length);n++)if(l[n].id===o)return{serverUrl:a,layerId:u[n].id}}else if(o!=null&&o<u.length)return{serverUrl:a,layerId:u[o].id};throw new Error("could not find matching associated sublayer")}async function V({sceneLayerItem:e,signal:i}){if(!e)return null;try{const r=(await e.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:i})).find(o=>o.type==="Feature Service")||null;if(!r)return null;const a=new f({portal:r.portal,id:r.id});return await a.load(),a}catch(r){return m(r),null}}export{R as a,S as l};
