import{aA as t,dZ as L,av as s,dU as f,dV as T,aw as m,ax as y,gx as D}from"./index-9f45a803.js";const R={BingMapsLayer:async()=>(await t(()=>import("./BingMapsLayer-3492ffa0.js"),["./BingMapsLayer-3492ffa0.js","./index-9f45a803.js","./index-fa8fa232.css","./imageBitmapUtils-2745a3dd.js"],import.meta.url)).default,BuildingSceneLayer:async()=>(await t(()=>import("./BuildingSceneLayer-ce5203f2.js"),["./BuildingSceneLayer-ce5203f2.js","./index-9f45a803.js","./index-fa8fa232.css","./BuildingComponentSublayer-463c6201.js","./FeatureLayer-8a51f7a5.js","./FeatureLayerBase-92b7f9eb.js","./LayerFloorInfo-1d5335c0.js","./serviceCapabilitiesUtils-4a29fbf5.js","./editsZScale-83133c82.js","./queryZScale-14796f3a.js","./FeatureSet-2173b2b2.js","./APIKeyMixin-534b85f1.js","./EditBusLayer-3ae44e81.js","./OrderedLayer-22ee0767.js","./FeatureTemplate-bc810822.js","./FeatureType-7510e906.js","./versionUtils-5df76877.js","./TopFeaturesQuery-ac4f1da0.js","./capabilities-c607cf72.js","./I3SIndexInfo-3dba2803.js","./I3SLayerDefinitions-ee3ab8c4.js","./I3SUtil-0ecbd3d3.js","./I3SBinaryReader-de5c2b04.js","./popupUtils-6fa24588.js","./BuildingGroupSublayer-f5999910.js","./SceneService-6f5e2664.js","./elevationInfoUtils-b9175039.js"],import.meta.url)).default,CSVLayer:async()=>(await t(()=>import("./CSVLayer-1c0866ec.js"),["./CSVLayer-1c0866ec.js","./index-9f45a803.js","./index-fa8fa232.css","./FeatureLayer-8a51f7a5.js","./FeatureLayerBase-92b7f9eb.js","./LayerFloorInfo-1d5335c0.js","./serviceCapabilitiesUtils-4a29fbf5.js","./editsZScale-83133c82.js","./queryZScale-14796f3a.js","./FeatureSet-2173b2b2.js","./APIKeyMixin-534b85f1.js","./EditBusLayer-3ae44e81.js","./OrderedLayer-22ee0767.js","./FeatureTemplate-bc810822.js","./FeatureType-7510e906.js","./versionUtils-5df76877.js","./TopFeaturesQuery-ac4f1da0.js","./clientSideDefaults-20bc79e2.js","./QueryEngineCapabilities-85c4f1d0.js"],import.meta.url)).default,DimensionLayer:async()=>(await t(()=>import("./DimensionLayer-16444c29.js"),["./DimensionLayer-16444c29.js","./index-9f45a803.js","./index-fa8fa232.css","./Analysis-6ea45b10.js","./LengthDimension-af15bfcd.js"],import.meta.url)).default,ElevationLayer:async()=>(await t(()=>import("./ElevationLayer-45ec7c5d.js"),["./ElevationLayer-45ec7c5d.js","./index-9f45a803.js","./index-fa8fa232.css","./ArcGISCachedService-2a1f9670.js","./TileInfoTilemapCache-264860e7.js","./TilemapCache-ecec870b.js"],import.meta.url)).default,FeatureLayer:async()=>(await t(()=>import("./FeatureLayer-8a51f7a5.js"),["./FeatureLayer-8a51f7a5.js","./index-9f45a803.js","./index-fa8fa232.css","./FeatureLayerBase-92b7f9eb.js","./LayerFloorInfo-1d5335c0.js","./serviceCapabilitiesUtils-4a29fbf5.js","./editsZScale-83133c82.js","./queryZScale-14796f3a.js","./FeatureSet-2173b2b2.js","./APIKeyMixin-534b85f1.js","./EditBusLayer-3ae44e81.js","./OrderedLayer-22ee0767.js","./FeatureTemplate-bc810822.js","./FeatureType-7510e906.js","./versionUtils-5df76877.js","./TopFeaturesQuery-ac4f1da0.js"],import.meta.url)).default,GeoJSONLayer:async()=>(await t(()=>import("./GeoJSONLayer-17f97063.js"),["./GeoJSONLayer-17f97063.js","./index-9f45a803.js","./index-fa8fa232.css","./clientSideDefaults-20bc79e2.js","./QueryEngineCapabilities-85c4f1d0.js","./FeatureSet-2173b2b2.js","./OrderedLayer-22ee0767.js","./FeatureTemplate-bc810822.js","./FeatureType-7510e906.js"],import.meta.url)).default,GeoRSSLayer:async()=>(await t(()=>import("./GeoRSSLayer-8584c301.js"),["./GeoRSSLayer-8584c301.js","./index-9f45a803.js","./index-fa8fa232.css"],import.meta.url)).default,GroupLayer:async()=>(await t(()=>import("./GroupLayer-e3e5b53f.js"),["./GroupLayer-e3e5b53f.js","./index-9f45a803.js","./index-fa8fa232.css"],import.meta.url)).default,ImageryLayer:async()=>(await t(()=>import("./ImageryLayer-bde16f3f.js"),["./ImageryLayer-bde16f3f.js","./index-9f45a803.js","./index-fa8fa232.css","./ImageHistogramParameters-93526986.js","./dataUtils-ca9b94ff.js","./pixelRangeUtils-367cd051.js","./generateRendererUtils-e0419035.js","./FeatureSet-2173b2b2.js","./imageBitmapUtils-2745a3dd.js","./executeQueryJSON-188ab9ff.js","./query-06688d95.js","./pbfQueryUtils-99cd93da.js","./pbf-20eb0c5c.js","./queryZScale-14796f3a.js","./AttachmentInfo-9c8825a1.js","./executeForIds-b1845745.js","./TopFeaturesQuery-ac4f1da0.js","./versionUtils-5df76877.js"],import.meta.url)).default,ImageryTileLayer:async()=>(await t(()=>import("./ImageryTileLayer-88ca2dd2.js"),["./ImageryTileLayer-88ca2dd2.js","./index-9f45a803.js","./index-fa8fa232.css","./ImageHistogramParameters-93526986.js","./dataUtils-ca9b94ff.js","./pixelRangeUtils-367cd051.js","./generateRendererUtils-e0419035.js","./FeatureSet-2173b2b2.js","./rasterProjectionHelper-fd90591a.js","./utils-9dd3f6fc.js","./TilemapCache-ecec870b.js"],import.meta.url)).default,IntegratedMeshLayer:async()=>(await t(()=>import("./IntegratedMeshLayer-d923187b.js"),["./IntegratedMeshLayer-d923187b.js","./index-9f45a803.js","./index-fa8fa232.css","./persistable-6bf58c68.js","./resourceExtension-9c7d175c.js","./APIKeyMixin-534b85f1.js","./SceneService-6f5e2664.js","./I3SIndexInfo-3dba2803.js","./I3SLayerDefinitions-ee3ab8c4.js","./SceneModification-482be830.js","./elevationInfoUtils-b9175039.js"],import.meta.url)).default,KMLLayer:async()=>(await t(()=>import("./KMLLayer-93ae6ece.js"),["./KMLLayer-93ae6ece.js","./index-9f45a803.js","./index-fa8fa232.css","./FeatureSet-2173b2b2.js"],import.meta.url)).default,LineOfSightLayer:async()=>(await t(()=>import("./LineOfSightLayer-eeb27535.js"),["./LineOfSightLayer-eeb27535.js","./index-9f45a803.js","./index-fa8fa232.css","./Analysis-6ea45b10.js","./LineOfSightAnalysisTarget-93e784a5.js","./persistable-6bf58c68.js","./resourceExtension-9c7d175c.js","./elevationInfoUtils-b9175039.js"],import.meta.url)).default,LinkChartLayer:async()=>(await t(()=>import("./LinkChartLayer-5e5fa6d0.js"),["./LinkChartLayer-5e5fa6d0.js","./index-9f45a803.js","./index-fa8fa232.css","./geohashUtils-77d8429b.js","./FeatureStore-a1c5375d.js","./BoundsStore-06767837.js","./PooledRBush-111c20e9.js","./quickselect-bc894a5c.js","./QueryEngine-63de7343.js","./WhereClause-1b5e4358.js","./TimeOnly-13c0e1f2.js","./json-48e3ea08.js","./QueryEngineCapabilities-85c4f1d0.js","./utils-5080f89d.js","./utils-869b9ed8.js","./generateRendererUtils-e0419035.js","./optimizedFeatureQueryEngineAdapter-69c20470.js","./clientSideDefaults-20bc79e2.js","./FeatureSet-2173b2b2.js"],import.meta.url)).default,MapImageLayer:async()=>(await t(()=>import("./MapImageLayer-ae0d6b7f.js"),["./MapImageLayer-ae0d6b7f.js","./index-9f45a803.js","./index-fa8fa232.css","./APIKeyMixin-534b85f1.js","./SublayersOwner-0fc07d4b.js","./QueryTask-40899462.js","./executeForIds-b1845745.js","./query-06688d95.js","./pbfQueryUtils-99cd93da.js","./pbf-20eb0c5c.js","./queryZScale-14796f3a.js","./executeQueryJSON-188ab9ff.js","./FeatureSet-2173b2b2.js","./executeQueryPBF-96046ecd.js","./FeatureType-7510e906.js","./FeatureTemplate-bc810822.js","./LayerFloorInfo-1d5335c0.js","./serviceCapabilitiesUtils-4a29fbf5.js","./sublayerUtils-e6b149e0.js","./ExportImageParameters-6866471c.js","./floorFilterUtils-73949d2d.js","./imageBitmapUtils-2745a3dd.js","./versionUtils-5df76877.js"],import.meta.url)).default,MapNotesLayer:async()=>(await t(()=>import("./MapNotesLayer-e29793cf.js"),["./MapNotesLayer-e29793cf.js","./index-9f45a803.js","./index-fa8fa232.css","./FeatureLayer-8a51f7a5.js","./FeatureLayerBase-92b7f9eb.js","./LayerFloorInfo-1d5335c0.js","./serviceCapabilitiesUtils-4a29fbf5.js","./editsZScale-83133c82.js","./queryZScale-14796f3a.js","./FeatureSet-2173b2b2.js","./APIKeyMixin-534b85f1.js","./EditBusLayer-3ae44e81.js","./OrderedLayer-22ee0767.js","./FeatureTemplate-bc810822.js","./FeatureType-7510e906.js","./versionUtils-5df76877.js","./TopFeaturesQuery-ac4f1da0.js","./objectIdUtils-967fafff.js"],import.meta.url)).default,MediaLayer:async()=>(await t(()=>import("./MediaLayer-3bd9f09f.js"),["./MediaLayer-3bd9f09f.js","./index-9f45a803.js","./index-fa8fa232.css","./MediaElementView-f2f1a352.js","./normalizeUtilsSync-e0f92fbf.js","./resourceExtension-9c7d175c.js","./BoundsStore-06767837.js","./PooledRBush-111c20e9.js","./quickselect-bc894a5c.js"],import.meta.url)).default,OGCFeatureLayer:async()=>(await t(()=>import("./OGCFeatureLayer-485e18f0.js"),["./OGCFeatureLayer-485e18f0.js","./index-9f45a803.js","./index-fa8fa232.css","./ogcFeatureUtils-62d27eee.js","./geojson-8abf57d7.js","./date-430969b3.js","./clientSideDefaults-20bc79e2.js","./QueryEngineCapabilities-85c4f1d0.js","./FeatureSet-2173b2b2.js","./APIKeyMixin-534b85f1.js","./OrderedLayer-22ee0767.js","./FeatureType-7510e906.js","./FeatureTemplate-bc810822.js"],import.meta.url)).default,OpenStreetMapLayer:async()=>(await t(()=>import("./OpenStreetMapLayer-b538242b.js"),["./OpenStreetMapLayer-b538242b.js","./index-9f45a803.js","./index-fa8fa232.css","./WebTileLayer-9d1d494b.js","./imageBitmapUtils-2745a3dd.js"],import.meta.url)).default,OrientedImageryLayer:async()=>(await t(()=>import("./OrientedImageryLayer-694a79d9.js"),["./OrientedImageryLayer-694a79d9.js","./index-9f45a803.js","./index-fa8fa232.css","./FeatureLayer-8a51f7a5.js","./FeatureLayerBase-92b7f9eb.js","./LayerFloorInfo-1d5335c0.js","./serviceCapabilitiesUtils-4a29fbf5.js","./editsZScale-83133c82.js","./queryZScale-14796f3a.js","./FeatureSet-2173b2b2.js","./APIKeyMixin-534b85f1.js","./EditBusLayer-3ae44e81.js","./OrderedLayer-22ee0767.js","./FeatureTemplate-bc810822.js","./FeatureType-7510e906.js","./versionUtils-5df76877.js","./TopFeaturesQuery-ac4f1da0.js"],import.meta.url)).default,PointCloudLayer:async()=>(await t(()=>import("./PointCloudLayer-56086e7c.js"),["./PointCloudLayer-56086e7c.js","./index-9f45a803.js","./index-fa8fa232.css","./APIKeyMixin-534b85f1.js","./SceneService-6f5e2664.js","./I3SIndexInfo-3dba2803.js","./PointCloudUniqueValueRenderer-cab54979.js","./elevationInfoUtils-b9175039.js"],import.meta.url)).default,RouteLayer:async()=>(await t(()=>import("./RouteLayer-368a269c.js"),["./RouteLayer-368a269c.js","./index-9f45a803.js","./index-fa8fa232.css","./Stop-1f0e7c48.js","./FeatureSet-2173b2b2.js"],import.meta.url)).default,SceneLayer:async()=>(await t(()=>import("./SceneLayer-1f85800a.js"),["./SceneLayer-1f85800a.js","./index-9f45a803.js","./index-fa8fa232.css","./APIKeyMixin-534b85f1.js","./EditBusLayer-3ae44e81.js","./SceneService-6f5e2664.js","./I3SIndexInfo-3dba2803.js","./capabilities-c607cf72.js","./I3SLayerDefinitions-ee3ab8c4.js","./LayerFloorInfo-1d5335c0.js","./persistable-6bf58c68.js","./resourceExtension-9c7d175c.js","./elevationInfoUtils-b9175039.js","./I3SUtil-0ecbd3d3.js","./I3SBinaryReader-de5c2b04.js","./popupUtils-6fa24588.js"],import.meta.url)).default,StreamLayer:async()=>(await t(()=>import("./index-9f45a803.js").then(e=>e.y8),["./index-9f45a803.js","./index-fa8fa232.css"],import.meta.url)).default,SubtypeGroupLayer:async()=>(await t(()=>import("./SubtypeGroupLayer-b018c9f4.js"),["./SubtypeGroupLayer-b018c9f4.js","./index-9f45a803.js","./index-fa8fa232.css","./APIKeyMixin-534b85f1.js","./EditBusLayer-3ae44e81.js","./FeatureLayerBase-92b7f9eb.js","./LayerFloorInfo-1d5335c0.js","./serviceCapabilitiesUtils-4a29fbf5.js","./FeatureTemplate-bc810822.js","./versionUtils-5df76877.js"],import.meta.url)).default,TileLayer:async()=>(await t(()=>import("./TileLayer-008e2713.js"),["./TileLayer-008e2713.js","./index-9f45a803.js","./index-fa8fa232.css","./APIKeyMixin-534b85f1.js","./ArcGISCachedService-2a1f9670.js","./TileInfoTilemapCache-264860e7.js","./TilemapCache-ecec870b.js","./SublayersOwner-0fc07d4b.js","./QueryTask-40899462.js","./executeForIds-b1845745.js","./query-06688d95.js","./pbfQueryUtils-99cd93da.js","./pbf-20eb0c5c.js","./queryZScale-14796f3a.js","./executeQueryJSON-188ab9ff.js","./FeatureSet-2173b2b2.js","./executeQueryPBF-96046ecd.js","./FeatureType-7510e906.js","./FeatureTemplate-bc810822.js","./LayerFloorInfo-1d5335c0.js","./serviceCapabilitiesUtils-4a29fbf5.js","./sublayerUtils-e6b149e0.js","./imageBitmapUtils-2745a3dd.js"],import.meta.url)).default,UnknownLayer:async()=>(await t(()=>import("./UnknownLayer-762c58f9.js"),["./UnknownLayer-762c58f9.js","./index-9f45a803.js","./index-fa8fa232.css"],import.meta.url)).default,UnsupportedLayer:async()=>(await t(()=>import("./UnsupportedLayer-ff11dcbc.js"),["./UnsupportedLayer-ff11dcbc.js","./index-9f45a803.js","./index-fa8fa232.css"],import.meta.url)).default,VectorTileLayer:async()=>(await t(()=>import("./VectorTileLayer-9a54889f.js"),["./VectorTileLayer-9a54889f.js","./index-9f45a803.js","./index-fa8fa232.css","./APIKeyMixin-534b85f1.js","./ArcGISCachedService-2a1f9670.js","./TileInfoTilemapCache-264860e7.js","./TilemapCache-ecec870b.js","./jsonContext-495ea283.js","./StyleRepository-bb58e815.js","./TileClipper-ae6eca9e.js","./definitions-997d2ea5.js"],import.meta.url)).default,VoxelLayer:async()=>(await t(()=>import("./VoxelLayer-97257b85.js"),["./VoxelLayer-97257b85.js","./index-9f45a803.js","./index-fa8fa232.css","./APIKeyMixin-534b85f1.js","./SceneService-6f5e2664.js","./I3SIndexInfo-3dba2803.js","./persistable-6bf58c68.js","./resourceExtension-9c7d175c.js"],import.meta.url)).default,WFSLayer:async()=>(await t(()=>import("./WFSLayer-4ff834e5.js"),["./WFSLayer-4ff834e5.js","./index-9f45a803.js","./index-fa8fa232.css","./clientSideDefaults-20bc79e2.js","./QueryEngineCapabilities-85c4f1d0.js","./wfsUtils-5258de4d.js","./geojson-8abf57d7.js","./date-430969b3.js","./xmlUtils-444cb4c0.js","./FeatureSet-2173b2b2.js","./OrderedLayer-22ee0767.js"],import.meta.url)).default,WMSLayer:async()=>(await t(()=>import("./WMSLayer-c6315bab.js"),["./WMSLayer-c6315bab.js","./index-9f45a803.js","./index-fa8fa232.css","./crsUtils-3bab3d8c.js","./ExportWMSImageParameters-2fd4221a.js","./imageBitmapUtils-2745a3dd.js"],import.meta.url)).default,WMTSLayer:async()=>(await t(()=>import("./WMTSLayer-9d5e5184.js"),["./WMTSLayer-9d5e5184.js","./index-9f45a803.js","./index-fa8fa232.css","./WebTileLayer-9d1d494b.js","./imageBitmapUtils-2745a3dd.js","./TileInfoTilemapCache-264860e7.js","./crsUtils-3bab3d8c.js","./xmlUtils-444cb4c0.js"],import.meta.url)).default,WebTileLayer:async()=>(await t(()=>import("./WebTileLayer-9d1d494b.js").then(e=>e.W),["./WebTileLayer-9d1d494b.js","./index-9f45a803.js","./index-fa8fa232.css","./imageBitmapUtils-2745a3dd.js"],import.meta.url)).default};async function S(e,i){const r=L(e);if(!r)throw new s("invalid-url","Invalid scene service url");const a={...i,sceneServerUrl:r.url.path,layerId:r.sublayer??void 0};if(a.sceneLayerItem??(a.sceneLayerItem=await A(a)),a.sceneLayerItem==null)return p(a.sceneServerUrl.replace("/SceneServer","/FeatureServer"),a);const o=await V(a);if(!o?.url)throw new s("related-service-not-found","Could not find feature service through portal item relationship");const _=await p(o.url,a);return _.portalItem=o,_}async function A(e){const i=(await E(e)).serviceItemId;if(!i)return null;const r=new f({id:i,apiKey:e.apiKey}),a=await O(e);a!=null&&(r.portal=new T({url:a}));try{return r.load({signal:e.signal})}catch(o){return m(o),null}}async function E(e){if(e.rootDocument)return e.rootDocument;const i={query:{f:"json",token:e.apiKey},responseType:"json",signal:e.signal};try{const r=await y(e.sceneServerUrl,i);e.rootDocument=r.data}catch{e.rootDocument={}}return e.rootDocument}async function O(e){const i=D?.findServerInfo(e.sceneServerUrl);if(i?.owningSystemUrl)return i.owningSystemUrl;const r=e.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const a=(await y(r,{query:{f:"json"},responseType:"json",signal:e.signal})).data.owningSystemUrl;if(a)return a}catch(a){m(a)}return null}async function p(e,i){const r=L(e);if(!r)throw new s("invalid-feature-service-url","Invalid feature service url");const a=r.url.path,o=i.layerId;if(o==null)return{serverUrl:a};const _=E(i),d=n=>{const I={query:{f:"json"},responseType:"json",authMode:n,signal:i.signal};return y(a,I)},v=d("anonymous").catch(()=>d("no-prompt")),[c,w]=await Promise.all([v,_]),l=w?.layers,u=c.data&&c.data.layers;if(!Array.isArray(u))throw new Error("expected layers array");if(Array.isArray(l)){for(let n=0;n<Math.min(l.length,u.length);n++)if(l[n].id===o)return{serverUrl:a,layerId:u[n].id}}else if(o!=null&&o<u.length)return{serverUrl:a,layerId:u[o].id};throw new Error("could not find matching associated sublayer")}async function V({sceneLayerItem:e,signal:i}){if(!e)return null;try{const r=(await e.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:i})).find(o=>o.type==="Feature Service")||null;if(!r)return null;const a=new f({portal:r.portal,id:r.id});return await a.load(),a}catch(r){return m(r),null}}export{R as a,S as l};
