import{aA as t,dZ as L,av as s,dU as f,dV as T,aw as m,ax as y,gx as D}from"./index-70a1e848.js";const R={BingMapsLayer:async()=>(await t(()=>import("./BingMapsLayer-fd169e20.js"),["./BingMapsLayer-fd169e20.js","./index-70a1e848.js","./index-fa8fa232.css","./imageBitmapUtils-d03e4154.js"],import.meta.url)).default,BuildingSceneLayer:async()=>(await t(()=>import("./BuildingSceneLayer-32feacae.js"),["./BuildingSceneLayer-32feacae.js","./index-70a1e848.js","./index-fa8fa232.css","./BuildingComponentSublayer-aae26ebd.js","./FeatureLayer-4b20d634.js","./FeatureLayerBase-d5b34521.js","./LayerFloorInfo-2c0a736f.js","./serviceCapabilitiesUtils-979570ad.js","./editsZScale-edfeccc6.js","./queryZScale-47976d5a.js","./FeatureSet-20ce479f.js","./APIKeyMixin-3e91b31f.js","./EditBusLayer-4de7f58b.js","./OrderedLayer-ea33712e.js","./FeatureTemplate-1a55ea44.js","./FeatureType-c8e18d40.js","./versionUtils-f448b405.js","./TopFeaturesQuery-62024588.js","./capabilities-c607cf72.js","./I3SIndexInfo-e8052f88.js","./I3SLayerDefinitions-677add91.js","./I3SUtil-0d0882d1.js","./I3SBinaryReader-b93e280e.js","./popupUtils-85d853d6.js","./BuildingGroupSublayer-509dfabe.js","./SceneService-ef65946f.js","./elevationInfoUtils-d483be9b.js"],import.meta.url)).default,CSVLayer:async()=>(await t(()=>import("./CSVLayer-8b5c669f.js"),["./CSVLayer-8b5c669f.js","./index-70a1e848.js","./index-fa8fa232.css","./FeatureLayer-4b20d634.js","./FeatureLayerBase-d5b34521.js","./LayerFloorInfo-2c0a736f.js","./serviceCapabilitiesUtils-979570ad.js","./editsZScale-edfeccc6.js","./queryZScale-47976d5a.js","./FeatureSet-20ce479f.js","./APIKeyMixin-3e91b31f.js","./EditBusLayer-4de7f58b.js","./OrderedLayer-ea33712e.js","./FeatureTemplate-1a55ea44.js","./FeatureType-c8e18d40.js","./versionUtils-f448b405.js","./TopFeaturesQuery-62024588.js","./clientSideDefaults-9edee6f4.js","./QueryEngineCapabilities-85c4f1d0.js"],import.meta.url)).default,DimensionLayer:async()=>(await t(()=>import("./DimensionLayer-d6bf0653.js"),["./DimensionLayer-d6bf0653.js","./index-70a1e848.js","./index-fa8fa232.css","./Analysis-8250bebb.js","./LengthDimension-dfef8776.js"],import.meta.url)).default,ElevationLayer:async()=>(await t(()=>import("./ElevationLayer-f947161d.js"),["./ElevationLayer-f947161d.js","./index-70a1e848.js","./index-fa8fa232.css","./ArcGISCachedService-ca5ddc60.js","./TileInfoTilemapCache-20ab7c46.js","./TilemapCache-91478691.js"],import.meta.url)).default,FeatureLayer:async()=>(await t(()=>import("./FeatureLayer-4b20d634.js"),["./FeatureLayer-4b20d634.js","./index-70a1e848.js","./index-fa8fa232.css","./FeatureLayerBase-d5b34521.js","./LayerFloorInfo-2c0a736f.js","./serviceCapabilitiesUtils-979570ad.js","./editsZScale-edfeccc6.js","./queryZScale-47976d5a.js","./FeatureSet-20ce479f.js","./APIKeyMixin-3e91b31f.js","./EditBusLayer-4de7f58b.js","./OrderedLayer-ea33712e.js","./FeatureTemplate-1a55ea44.js","./FeatureType-c8e18d40.js","./versionUtils-f448b405.js","./TopFeaturesQuery-62024588.js"],import.meta.url)).default,GeoJSONLayer:async()=>(await t(()=>import("./GeoJSONLayer-adbe16c6.js"),["./GeoJSONLayer-adbe16c6.js","./index-70a1e848.js","./index-fa8fa232.css","./clientSideDefaults-9edee6f4.js","./QueryEngineCapabilities-85c4f1d0.js","./FeatureSet-20ce479f.js","./OrderedLayer-ea33712e.js","./FeatureTemplate-1a55ea44.js","./FeatureType-c8e18d40.js"],import.meta.url)).default,GeoRSSLayer:async()=>(await t(()=>import("./GeoRSSLayer-675460a1.js"),["./GeoRSSLayer-675460a1.js","./index-70a1e848.js","./index-fa8fa232.css"],import.meta.url)).default,GroupLayer:async()=>(await t(()=>import("./GroupLayer-ddd5f412.js"),["./GroupLayer-ddd5f412.js","./index-70a1e848.js","./index-fa8fa232.css"],import.meta.url)).default,ImageryLayer:async()=>(await t(()=>import("./ImageryLayer-e557243d.js"),["./ImageryLayer-e557243d.js","./index-70a1e848.js","./index-fa8fa232.css","./ImageHistogramParameters-b457e587.js","./dataUtils-c41f9a51.js","./pixelRangeUtils-367cd051.js","./generateRendererUtils-45001f16.js","./FeatureSet-20ce479f.js","./imageBitmapUtils-d03e4154.js","./executeQueryJSON-c894fe77.js","./query-329b2ac1.js","./pbfQueryUtils-2cf66e2d.js","./pbf-b60d46d3.js","./queryZScale-47976d5a.js","./AttachmentInfo-1af1e30b.js","./executeForIds-d30371a5.js","./TopFeaturesQuery-62024588.js","./versionUtils-f448b405.js"],import.meta.url)).default,ImageryTileLayer:async()=>(await t(()=>import("./ImageryTileLayer-0de174e0.js"),["./ImageryTileLayer-0de174e0.js","./index-70a1e848.js","./index-fa8fa232.css","./ImageHistogramParameters-b457e587.js","./dataUtils-c41f9a51.js","./pixelRangeUtils-367cd051.js","./generateRendererUtils-45001f16.js","./FeatureSet-20ce479f.js","./rasterProjectionHelper-05232069.js","./utils-6b5312f8.js","./TilemapCache-91478691.js"],import.meta.url)).default,IntegratedMeshLayer:async()=>(await t(()=>import("./IntegratedMeshLayer-7b9d84c6.js"),["./IntegratedMeshLayer-7b9d84c6.js","./index-70a1e848.js","./index-fa8fa232.css","./persistable-11a51d0d.js","./resourceExtension-e91c0a13.js","./APIKeyMixin-3e91b31f.js","./SceneService-ef65946f.js","./I3SIndexInfo-e8052f88.js","./I3SLayerDefinitions-677add91.js","./SceneModification-f535d834.js","./elevationInfoUtils-d483be9b.js"],import.meta.url)).default,KMLLayer:async()=>(await t(()=>import("./KMLLayer-e939fe75.js"),["./KMLLayer-e939fe75.js","./index-70a1e848.js","./index-fa8fa232.css","./FeatureSet-20ce479f.js"],import.meta.url)).default,LineOfSightLayer:async()=>(await t(()=>import("./LineOfSightLayer-1a4d9785.js"),["./LineOfSightLayer-1a4d9785.js","./index-70a1e848.js","./index-fa8fa232.css","./Analysis-8250bebb.js","./LineOfSightAnalysisTarget-d8124b02.js","./persistable-11a51d0d.js","./resourceExtension-e91c0a13.js","./elevationInfoUtils-d483be9b.js"],import.meta.url)).default,LinkChartLayer:async()=>(await t(()=>import("./LinkChartLayer-2d493603.js"),["./LinkChartLayer-2d493603.js","./index-70a1e848.js","./index-fa8fa232.css","./geohashUtils-77d8429b.js","./FeatureStore-502a78b3.js","./BoundsStore-7941b063.js","./PooledRBush-a82b8470.js","./quickselect-cd6fa001.js","./QueryEngine-7a150f90.js","./WhereClause-813f9607.js","./TimeOnly-5ca21580.js","./json-48e3ea08.js","./QueryEngineCapabilities-85c4f1d0.js","./utils-d4e69d8a.js","./utils-e4f79b61.js","./generateRendererUtils-45001f16.js","./optimizedFeatureQueryEngineAdapter-68a83ac4.js","./clientSideDefaults-9edee6f4.js","./FeatureSet-20ce479f.js"],import.meta.url)).default,MapImageLayer:async()=>(await t(()=>import("./MapImageLayer-94c6b5b9.js"),["./MapImageLayer-94c6b5b9.js","./index-70a1e848.js","./index-fa8fa232.css","./APIKeyMixin-3e91b31f.js","./SublayersOwner-c1f099d0.js","./QueryTask-e0bc6c36.js","./executeForIds-d30371a5.js","./query-329b2ac1.js","./pbfQueryUtils-2cf66e2d.js","./pbf-b60d46d3.js","./queryZScale-47976d5a.js","./executeQueryJSON-c894fe77.js","./FeatureSet-20ce479f.js","./executeQueryPBF-1084faae.js","./FeatureType-c8e18d40.js","./FeatureTemplate-1a55ea44.js","./LayerFloorInfo-2c0a736f.js","./serviceCapabilitiesUtils-979570ad.js","./sublayerUtils-453a6830.js","./ExportImageParameters-669c498d.js","./floorFilterUtils-73949d2d.js","./imageBitmapUtils-d03e4154.js","./versionUtils-f448b405.js"],import.meta.url)).default,MapNotesLayer:async()=>(await t(()=>import("./MapNotesLayer-d3ae07df.js"),["./MapNotesLayer-d3ae07df.js","./index-70a1e848.js","./index-fa8fa232.css","./FeatureLayer-4b20d634.js","./FeatureLayerBase-d5b34521.js","./LayerFloorInfo-2c0a736f.js","./serviceCapabilitiesUtils-979570ad.js","./editsZScale-edfeccc6.js","./queryZScale-47976d5a.js","./FeatureSet-20ce479f.js","./APIKeyMixin-3e91b31f.js","./EditBusLayer-4de7f58b.js","./OrderedLayer-ea33712e.js","./FeatureTemplate-1a55ea44.js","./FeatureType-c8e18d40.js","./versionUtils-f448b405.js","./TopFeaturesQuery-62024588.js","./objectIdUtils-967fafff.js"],import.meta.url)).default,MediaLayer:async()=>(await t(()=>import("./MediaLayer-a0eb89c4.js"),["./MediaLayer-a0eb89c4.js","./index-70a1e848.js","./index-fa8fa232.css","./MediaElementView-a0def988.js","./normalizeUtilsSync-11fd9991.js","./resourceExtension-e91c0a13.js","./BoundsStore-7941b063.js","./PooledRBush-a82b8470.js","./quickselect-cd6fa001.js"],import.meta.url)).default,OGCFeatureLayer:async()=>(await t(()=>import("./OGCFeatureLayer-0dbce18a.js"),["./OGCFeatureLayer-0dbce18a.js","./index-70a1e848.js","./index-fa8fa232.css","./ogcFeatureUtils-22595d5c.js","./geojson-8889f8c8.js","./date-430969b3.js","./clientSideDefaults-9edee6f4.js","./QueryEngineCapabilities-85c4f1d0.js","./FeatureSet-20ce479f.js","./APIKeyMixin-3e91b31f.js","./OrderedLayer-ea33712e.js","./FeatureType-c8e18d40.js","./FeatureTemplate-1a55ea44.js"],import.meta.url)).default,OpenStreetMapLayer:async()=>(await t(()=>import("./OpenStreetMapLayer-81235de9.js"),["./OpenStreetMapLayer-81235de9.js","./index-70a1e848.js","./index-fa8fa232.css","./WebTileLayer-f1e8c737.js","./imageBitmapUtils-d03e4154.js"],import.meta.url)).default,OrientedImageryLayer:async()=>(await t(()=>import("./OrientedImageryLayer-fd5780fd.js"),["./OrientedImageryLayer-fd5780fd.js","./index-70a1e848.js","./index-fa8fa232.css","./FeatureLayer-4b20d634.js","./FeatureLayerBase-d5b34521.js","./LayerFloorInfo-2c0a736f.js","./serviceCapabilitiesUtils-979570ad.js","./editsZScale-edfeccc6.js","./queryZScale-47976d5a.js","./FeatureSet-20ce479f.js","./APIKeyMixin-3e91b31f.js","./EditBusLayer-4de7f58b.js","./OrderedLayer-ea33712e.js","./FeatureTemplate-1a55ea44.js","./FeatureType-c8e18d40.js","./versionUtils-f448b405.js","./TopFeaturesQuery-62024588.js"],import.meta.url)).default,PointCloudLayer:async()=>(await t(()=>import("./PointCloudLayer-6e8f246f.js"),["./PointCloudLayer-6e8f246f.js","./index-70a1e848.js","./index-fa8fa232.css","./APIKeyMixin-3e91b31f.js","./SceneService-ef65946f.js","./I3SIndexInfo-e8052f88.js","./PointCloudUniqueValueRenderer-f29eb455.js","./elevationInfoUtils-d483be9b.js"],import.meta.url)).default,RouteLayer:async()=>(await t(()=>import("./RouteLayer-bbb4ef71.js"),["./RouteLayer-bbb4ef71.js","./index-70a1e848.js","./index-fa8fa232.css","./Stop-59e290f7.js","./FeatureSet-20ce479f.js"],import.meta.url)).default,SceneLayer:async()=>(await t(()=>import("./SceneLayer-d21757fa.js"),["./SceneLayer-d21757fa.js","./index-70a1e848.js","./index-fa8fa232.css","./APIKeyMixin-3e91b31f.js","./EditBusLayer-4de7f58b.js","./SceneService-ef65946f.js","./I3SIndexInfo-e8052f88.js","./capabilities-c607cf72.js","./I3SLayerDefinitions-677add91.js","./LayerFloorInfo-2c0a736f.js","./persistable-11a51d0d.js","./resourceExtension-e91c0a13.js","./elevationInfoUtils-d483be9b.js","./I3SUtil-0d0882d1.js","./I3SBinaryReader-b93e280e.js","./popupUtils-85d853d6.js"],import.meta.url)).default,StreamLayer:async()=>(await t(()=>import("./index-70a1e848.js").then(e=>e.y8),["./index-70a1e848.js","./index-fa8fa232.css"],import.meta.url)).default,SubtypeGroupLayer:async()=>(await t(()=>import("./SubtypeGroupLayer-3274c2b9.js"),["./SubtypeGroupLayer-3274c2b9.js","./index-70a1e848.js","./index-fa8fa232.css","./APIKeyMixin-3e91b31f.js","./EditBusLayer-4de7f58b.js","./FeatureLayerBase-d5b34521.js","./LayerFloorInfo-2c0a736f.js","./serviceCapabilitiesUtils-979570ad.js","./FeatureTemplate-1a55ea44.js","./versionUtils-f448b405.js"],import.meta.url)).default,TileLayer:async()=>(await t(()=>import("./TileLayer-5135219d.js"),["./TileLayer-5135219d.js","./index-70a1e848.js","./index-fa8fa232.css","./APIKeyMixin-3e91b31f.js","./ArcGISCachedService-ca5ddc60.js","./TileInfoTilemapCache-20ab7c46.js","./TilemapCache-91478691.js","./SublayersOwner-c1f099d0.js","./QueryTask-e0bc6c36.js","./executeForIds-d30371a5.js","./query-329b2ac1.js","./pbfQueryUtils-2cf66e2d.js","./pbf-b60d46d3.js","./queryZScale-47976d5a.js","./executeQueryJSON-c894fe77.js","./FeatureSet-20ce479f.js","./executeQueryPBF-1084faae.js","./FeatureType-c8e18d40.js","./FeatureTemplate-1a55ea44.js","./LayerFloorInfo-2c0a736f.js","./serviceCapabilitiesUtils-979570ad.js","./sublayerUtils-453a6830.js","./imageBitmapUtils-d03e4154.js"],import.meta.url)).default,UnknownLayer:async()=>(await t(()=>import("./UnknownLayer-83f572c6.js"),["./UnknownLayer-83f572c6.js","./index-70a1e848.js","./index-fa8fa232.css"],import.meta.url)).default,UnsupportedLayer:async()=>(await t(()=>import("./UnsupportedLayer-55eb64b1.js"),["./UnsupportedLayer-55eb64b1.js","./index-70a1e848.js","./index-fa8fa232.css"],import.meta.url)).default,VectorTileLayer:async()=>(await t(()=>import("./VectorTileLayer-49d4c2c9.js"),["./VectorTileLayer-49d4c2c9.js","./index-70a1e848.js","./index-fa8fa232.css","./APIKeyMixin-3e91b31f.js","./ArcGISCachedService-ca5ddc60.js","./TileInfoTilemapCache-20ab7c46.js","./TilemapCache-91478691.js","./jsonContext-663a523d.js","./StyleRepository-43550a47.js","./TileClipper-ae6eca9e.js","./definitions-24b8f578.js"],import.meta.url)).default,VoxelLayer:async()=>(await t(()=>import("./VoxelLayer-74d80557.js"),["./VoxelLayer-74d80557.js","./index-70a1e848.js","./index-fa8fa232.css","./APIKeyMixin-3e91b31f.js","./SceneService-ef65946f.js","./I3SIndexInfo-e8052f88.js","./persistable-11a51d0d.js","./resourceExtension-e91c0a13.js"],import.meta.url)).default,WFSLayer:async()=>(await t(()=>import("./WFSLayer-2d156bb3.js"),["./WFSLayer-2d156bb3.js","./index-70a1e848.js","./index-fa8fa232.css","./clientSideDefaults-9edee6f4.js","./QueryEngineCapabilities-85c4f1d0.js","./wfsUtils-5a7e83e6.js","./geojson-8889f8c8.js","./date-430969b3.js","./xmlUtils-444cb4c0.js","./FeatureSet-20ce479f.js","./OrderedLayer-ea33712e.js"],import.meta.url)).default,WMSLayer:async()=>(await t(()=>import("./WMSLayer-45d0a482.js"),["./WMSLayer-45d0a482.js","./index-70a1e848.js","./index-fa8fa232.css","./crsUtils-3bab3d8c.js","./ExportWMSImageParameters-47d58d9b.js","./imageBitmapUtils-d03e4154.js"],import.meta.url)).default,WMTSLayer:async()=>(await t(()=>import("./WMTSLayer-cc460985.js"),["./WMTSLayer-cc460985.js","./index-70a1e848.js","./index-fa8fa232.css","./WebTileLayer-f1e8c737.js","./imageBitmapUtils-d03e4154.js","./TileInfoTilemapCache-20ab7c46.js","./crsUtils-3bab3d8c.js","./xmlUtils-444cb4c0.js"],import.meta.url)).default,WebTileLayer:async()=>(await t(()=>import("./WebTileLayer-f1e8c737.js").then(e=>e.W),["./WebTileLayer-f1e8c737.js","./index-70a1e848.js","./index-fa8fa232.css","./imageBitmapUtils-d03e4154.js"],import.meta.url)).default};async function S(e,i){const r=L(e);if(!r)throw new s("invalid-url","Invalid scene service url");const a={...i,sceneServerUrl:r.url.path,layerId:r.sublayer??void 0};if(a.sceneLayerItem??(a.sceneLayerItem=await A(a)),a.sceneLayerItem==null)return p(a.sceneServerUrl.replace("/SceneServer","/FeatureServer"),a);const o=await V(a);if(!o?.url)throw new s("related-service-not-found","Could not find feature service through portal item relationship");const _=await p(o.url,a);return _.portalItem=o,_}async function A(e){const i=(await E(e)).serviceItemId;if(!i)return null;const r=new f({id:i,apiKey:e.apiKey}),a=await O(e);a!=null&&(r.portal=new T({url:a}));try{return r.load({signal:e.signal})}catch(o){return m(o),null}}async function E(e){if(e.rootDocument)return e.rootDocument;const i={query:{f:"json",token:e.apiKey},responseType:"json",signal:e.signal};try{const r=await y(e.sceneServerUrl,i);e.rootDocument=r.data}catch{e.rootDocument={}}return e.rootDocument}async function O(e){const i=D?.findServerInfo(e.sceneServerUrl);if(i?.owningSystemUrl)return i.owningSystemUrl;const r=e.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const a=(await y(r,{query:{f:"json"},responseType:"json",signal:e.signal})).data.owningSystemUrl;if(a)return a}catch(a){m(a)}return null}async function p(e,i){const r=L(e);if(!r)throw new s("invalid-feature-service-url","Invalid feature service url");const a=r.url.path,o=i.layerId;if(o==null)return{serverUrl:a};const _=E(i),d=n=>{const I={query:{f:"json"},responseType:"json",authMode:n,signal:i.signal};return y(a,I)},v=d("anonymous").catch(()=>d("no-prompt")),[c,w]=await Promise.all([v,_]),l=w?.layers,u=c.data&&c.data.layers;if(!Array.isArray(u))throw new Error("expected layers array");if(Array.isArray(l)){for(let n=0;n<Math.min(l.length,u.length);n++)if(l[n].id===o)return{serverUrl:a,layerId:u[n].id}}else if(o!=null&&o<u.length)return{serverUrl:a,layerId:u[o].id};throw new Error("could not find matching associated sublayer")}async function V({sceneLayerItem:e,signal:i}){if(!e)return null;try{const r=(await e.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:i})).find(o=>o.type==="Feature Service")||null;if(!r)return null;const a=new f({portal:r.portal,id:r.id});return await a.load(),a}catch(r){return m(r),null}}export{R as a,S as l};
