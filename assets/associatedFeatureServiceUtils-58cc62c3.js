import{aA as t,dZ as L,av as s,dU as f,dV as T,aw as m,ax as y,gx as D}from"./index-35e234f2.js";const R={BingMapsLayer:async()=>(await t(()=>import("./BingMapsLayer-4925ac01.js"),["./BingMapsLayer-4925ac01.js","./index-35e234f2.js","./index-fa8fa232.css","./imageBitmapUtils-e2807ce7.js"],import.meta.url)).default,BuildingSceneLayer:async()=>(await t(()=>import("./BuildingSceneLayer-efdcb1bf.js"),["./BuildingSceneLayer-efdcb1bf.js","./index-35e234f2.js","./index-fa8fa232.css","./BuildingComponentSublayer-9c1b4fa7.js","./FeatureLayer-9829508f.js","./FeatureLayerBase-10159930.js","./LayerFloorInfo-ecc28037.js","./serviceCapabilitiesUtils-4d535ec8.js","./editsZScale-0d82aaec.js","./queryZScale-4260d97b.js","./FeatureSet-890fea54.js","./APIKeyMixin-06dcd75c.js","./EditBusLayer-1e43d65d.js","./OrderedLayer-c6a4e08e.js","./FeatureTemplate-d9befeeb.js","./FeatureType-868607ca.js","./versionUtils-50becd2c.js","./TopFeaturesQuery-798ec155.js","./capabilities-c607cf72.js","./I3SIndexInfo-0e348d7c.js","./I3SLayerDefinitions-7418d390.js","./I3SUtil-62855860.js","./I3SBinaryReader-b2b909f3.js","./popupUtils-024db583.js","./BuildingGroupSublayer-7f0b726e.js","./SceneService-82f9501e.js","./elevationInfoUtils-90633ec5.js"],import.meta.url)).default,CSVLayer:async()=>(await t(()=>import("./CSVLayer-bdb997cf.js"),["./CSVLayer-bdb997cf.js","./index-35e234f2.js","./index-fa8fa232.css","./FeatureLayer-9829508f.js","./FeatureLayerBase-10159930.js","./LayerFloorInfo-ecc28037.js","./serviceCapabilitiesUtils-4d535ec8.js","./editsZScale-0d82aaec.js","./queryZScale-4260d97b.js","./FeatureSet-890fea54.js","./APIKeyMixin-06dcd75c.js","./EditBusLayer-1e43d65d.js","./OrderedLayer-c6a4e08e.js","./FeatureTemplate-d9befeeb.js","./FeatureType-868607ca.js","./versionUtils-50becd2c.js","./TopFeaturesQuery-798ec155.js","./clientSideDefaults-068ef0e1.js","./QueryEngineCapabilities-85c4f1d0.js"],import.meta.url)).default,DimensionLayer:async()=>(await t(()=>import("./DimensionLayer-b619a543.js"),["./DimensionLayer-b619a543.js","./index-35e234f2.js","./index-fa8fa232.css","./Analysis-74824dcc.js","./LengthDimension-90a1e1cd.js"],import.meta.url)).default,ElevationLayer:async()=>(await t(()=>import("./ElevationLayer-e3ecff64.js"),["./ElevationLayer-e3ecff64.js","./index-35e234f2.js","./index-fa8fa232.css","./ArcGISCachedService-88e1d458.js","./TileInfoTilemapCache-0d76913b.js","./TilemapCache-d32eb7af.js"],import.meta.url)).default,FeatureLayer:async()=>(await t(()=>import("./FeatureLayer-9829508f.js"),["./FeatureLayer-9829508f.js","./index-35e234f2.js","./index-fa8fa232.css","./FeatureLayerBase-10159930.js","./LayerFloorInfo-ecc28037.js","./serviceCapabilitiesUtils-4d535ec8.js","./editsZScale-0d82aaec.js","./queryZScale-4260d97b.js","./FeatureSet-890fea54.js","./APIKeyMixin-06dcd75c.js","./EditBusLayer-1e43d65d.js","./OrderedLayer-c6a4e08e.js","./FeatureTemplate-d9befeeb.js","./FeatureType-868607ca.js","./versionUtils-50becd2c.js","./TopFeaturesQuery-798ec155.js"],import.meta.url)).default,GeoJSONLayer:async()=>(await t(()=>import("./GeoJSONLayer-c82f65f2.js"),["./GeoJSONLayer-c82f65f2.js","./index-35e234f2.js","./index-fa8fa232.css","./clientSideDefaults-068ef0e1.js","./QueryEngineCapabilities-85c4f1d0.js","./FeatureSet-890fea54.js","./OrderedLayer-c6a4e08e.js","./FeatureTemplate-d9befeeb.js","./FeatureType-868607ca.js"],import.meta.url)).default,GeoRSSLayer:async()=>(await t(()=>import("./GeoRSSLayer-5118c621.js"),["./GeoRSSLayer-5118c621.js","./index-35e234f2.js","./index-fa8fa232.css"],import.meta.url)).default,GroupLayer:async()=>(await t(()=>import("./GroupLayer-1f91d2ae.js"),["./GroupLayer-1f91d2ae.js","./index-35e234f2.js","./index-fa8fa232.css"],import.meta.url)).default,ImageryLayer:async()=>(await t(()=>import("./ImageryLayer-57de1f31.js"),["./ImageryLayer-57de1f31.js","./index-35e234f2.js","./index-fa8fa232.css","./ImageHistogramParameters-29f6a88d.js","./dataUtils-944a1a05.js","./pixelRangeUtils-367cd051.js","./generateRendererUtils-023c7e78.js","./FeatureSet-890fea54.js","./imageBitmapUtils-e2807ce7.js","./executeQueryJSON-d5f14792.js","./query-7fb34953.js","./pbfQueryUtils-06ca1a31.js","./pbf-20893484.js","./queryZScale-4260d97b.js","./AttachmentInfo-ba14dfae.js","./executeForIds-5b595fba.js","./TopFeaturesQuery-798ec155.js","./versionUtils-50becd2c.js"],import.meta.url)).default,ImageryTileLayer:async()=>(await t(()=>import("./ImageryTileLayer-0ed37107.js"),["./ImageryTileLayer-0ed37107.js","./index-35e234f2.js","./index-fa8fa232.css","./ImageHistogramParameters-29f6a88d.js","./dataUtils-944a1a05.js","./pixelRangeUtils-367cd051.js","./generateRendererUtils-023c7e78.js","./FeatureSet-890fea54.js","./rasterProjectionHelper-15c87eab.js","./utils-bac339a9.js","./TilemapCache-d32eb7af.js"],import.meta.url)).default,IntegratedMeshLayer:async()=>(await t(()=>import("./IntegratedMeshLayer-50d92f8d.js"),["./IntegratedMeshLayer-50d92f8d.js","./index-35e234f2.js","./index-fa8fa232.css","./persistable-ec035db7.js","./resourceExtension-f8a8d36e.js","./APIKeyMixin-06dcd75c.js","./SceneService-82f9501e.js","./I3SIndexInfo-0e348d7c.js","./I3SLayerDefinitions-7418d390.js","./SceneModification-dab2fc86.js","./elevationInfoUtils-90633ec5.js"],import.meta.url)).default,KMLLayer:async()=>(await t(()=>import("./KMLLayer-9e414228.js"),["./KMLLayer-9e414228.js","./index-35e234f2.js","./index-fa8fa232.css","./FeatureSet-890fea54.js"],import.meta.url)).default,LineOfSightLayer:async()=>(await t(()=>import("./LineOfSightLayer-498742ea.js"),["./LineOfSightLayer-498742ea.js","./index-35e234f2.js","./index-fa8fa232.css","./Analysis-74824dcc.js","./LineOfSightAnalysisTarget-50d58d6c.js","./persistable-ec035db7.js","./resourceExtension-f8a8d36e.js","./elevationInfoUtils-90633ec5.js"],import.meta.url)).default,LinkChartLayer:async()=>(await t(()=>import("./LinkChartLayer-224a24a6.js"),["./LinkChartLayer-224a24a6.js","./index-35e234f2.js","./index-fa8fa232.css","./geohashUtils-77d8429b.js","./FeatureStore-3a774eae.js","./BoundsStore-60c472e1.js","./PooledRBush-79fb96bc.js","./quickselect-1f3831f7.js","./QueryEngine-ffb0d164.js","./WhereClause-ad516fc1.js","./TimeOnly-0aaf2515.js","./json-48e3ea08.js","./QueryEngineCapabilities-85c4f1d0.js","./utils-d72db9aa.js","./utils-117069f5.js","./generateRendererUtils-023c7e78.js","./optimizedFeatureQueryEngineAdapter-f30d1b42.js","./clientSideDefaults-068ef0e1.js","./FeatureSet-890fea54.js"],import.meta.url)).default,MapImageLayer:async()=>(await t(()=>import("./MapImageLayer-4a7e855b.js"),["./MapImageLayer-4a7e855b.js","./index-35e234f2.js","./index-fa8fa232.css","./APIKeyMixin-06dcd75c.js","./SublayersOwner-bb15b743.js","./QueryTask-44320cc4.js","./executeForIds-5b595fba.js","./query-7fb34953.js","./pbfQueryUtils-06ca1a31.js","./pbf-20893484.js","./queryZScale-4260d97b.js","./executeQueryJSON-d5f14792.js","./FeatureSet-890fea54.js","./executeQueryPBF-fdbd0a42.js","./FeatureType-868607ca.js","./FeatureTemplate-d9befeeb.js","./LayerFloorInfo-ecc28037.js","./serviceCapabilitiesUtils-4d535ec8.js","./sublayerUtils-c6f9d89f.js","./ExportImageParameters-93b89e4c.js","./floorFilterUtils-73949d2d.js","./imageBitmapUtils-e2807ce7.js","./versionUtils-50becd2c.js"],import.meta.url)).default,MapNotesLayer:async()=>(await t(()=>import("./MapNotesLayer-375c1ba1.js"),["./MapNotesLayer-375c1ba1.js","./index-35e234f2.js","./index-fa8fa232.css","./FeatureLayer-9829508f.js","./FeatureLayerBase-10159930.js","./LayerFloorInfo-ecc28037.js","./serviceCapabilitiesUtils-4d535ec8.js","./editsZScale-0d82aaec.js","./queryZScale-4260d97b.js","./FeatureSet-890fea54.js","./APIKeyMixin-06dcd75c.js","./EditBusLayer-1e43d65d.js","./OrderedLayer-c6a4e08e.js","./FeatureTemplate-d9befeeb.js","./FeatureType-868607ca.js","./versionUtils-50becd2c.js","./TopFeaturesQuery-798ec155.js","./objectIdUtils-967fafff.js"],import.meta.url)).default,MediaLayer:async()=>(await t(()=>import("./MediaLayer-e9b78cbd.js"),["./MediaLayer-e9b78cbd.js","./index-35e234f2.js","./index-fa8fa232.css","./MediaElementView-145ee692.js","./normalizeUtilsSync-86308afc.js","./resourceExtension-f8a8d36e.js","./BoundsStore-60c472e1.js","./PooledRBush-79fb96bc.js","./quickselect-1f3831f7.js"],import.meta.url)).default,OGCFeatureLayer:async()=>(await t(()=>import("./OGCFeatureLayer-56054fae.js"),["./OGCFeatureLayer-56054fae.js","./index-35e234f2.js","./index-fa8fa232.css","./ogcFeatureUtils-d9e2e1ae.js","./geojson-6d7ec271.js","./date-430969b3.js","./clientSideDefaults-068ef0e1.js","./QueryEngineCapabilities-85c4f1d0.js","./FeatureSet-890fea54.js","./APIKeyMixin-06dcd75c.js","./OrderedLayer-c6a4e08e.js","./FeatureType-868607ca.js","./FeatureTemplate-d9befeeb.js"],import.meta.url)).default,OpenStreetMapLayer:async()=>(await t(()=>import("./OpenStreetMapLayer-9282e2e8.js"),["./OpenStreetMapLayer-9282e2e8.js","./index-35e234f2.js","./index-fa8fa232.css","./WebTileLayer-99295163.js","./imageBitmapUtils-e2807ce7.js"],import.meta.url)).default,OrientedImageryLayer:async()=>(await t(()=>import("./OrientedImageryLayer-af691c5a.js"),["./OrientedImageryLayer-af691c5a.js","./index-35e234f2.js","./index-fa8fa232.css","./FeatureLayer-9829508f.js","./FeatureLayerBase-10159930.js","./LayerFloorInfo-ecc28037.js","./serviceCapabilitiesUtils-4d535ec8.js","./editsZScale-0d82aaec.js","./queryZScale-4260d97b.js","./FeatureSet-890fea54.js","./APIKeyMixin-06dcd75c.js","./EditBusLayer-1e43d65d.js","./OrderedLayer-c6a4e08e.js","./FeatureTemplate-d9befeeb.js","./FeatureType-868607ca.js","./versionUtils-50becd2c.js","./TopFeaturesQuery-798ec155.js"],import.meta.url)).default,PointCloudLayer:async()=>(await t(()=>import("./PointCloudLayer-dabf9792.js"),["./PointCloudLayer-dabf9792.js","./index-35e234f2.js","./index-fa8fa232.css","./APIKeyMixin-06dcd75c.js","./SceneService-82f9501e.js","./I3SIndexInfo-0e348d7c.js","./PointCloudUniqueValueRenderer-58fd4285.js","./elevationInfoUtils-90633ec5.js"],import.meta.url)).default,RouteLayer:async()=>(await t(()=>import("./RouteLayer-f585d6eb.js"),["./RouteLayer-f585d6eb.js","./index-35e234f2.js","./index-fa8fa232.css","./Stop-9931d982.js","./FeatureSet-890fea54.js"],import.meta.url)).default,SceneLayer:async()=>(await t(()=>import("./SceneLayer-d7ab426d.js"),["./SceneLayer-d7ab426d.js","./index-35e234f2.js","./index-fa8fa232.css","./APIKeyMixin-06dcd75c.js","./EditBusLayer-1e43d65d.js","./SceneService-82f9501e.js","./I3SIndexInfo-0e348d7c.js","./capabilities-c607cf72.js","./I3SLayerDefinitions-7418d390.js","./LayerFloorInfo-ecc28037.js","./persistable-ec035db7.js","./resourceExtension-f8a8d36e.js","./elevationInfoUtils-90633ec5.js","./I3SUtil-62855860.js","./I3SBinaryReader-b2b909f3.js","./popupUtils-024db583.js"],import.meta.url)).default,StreamLayer:async()=>(await t(()=>import("./index-35e234f2.js").then(e=>e.y8),["./index-35e234f2.js","./index-fa8fa232.css"],import.meta.url)).default,SubtypeGroupLayer:async()=>(await t(()=>import("./SubtypeGroupLayer-60c44a8e.js"),["./SubtypeGroupLayer-60c44a8e.js","./index-35e234f2.js","./index-fa8fa232.css","./APIKeyMixin-06dcd75c.js","./EditBusLayer-1e43d65d.js","./FeatureLayerBase-10159930.js","./LayerFloorInfo-ecc28037.js","./serviceCapabilitiesUtils-4d535ec8.js","./FeatureTemplate-d9befeeb.js","./versionUtils-50becd2c.js"],import.meta.url)).default,TileLayer:async()=>(await t(()=>import("./TileLayer-ef73ceb9.js"),["./TileLayer-ef73ceb9.js","./index-35e234f2.js","./index-fa8fa232.css","./APIKeyMixin-06dcd75c.js","./ArcGISCachedService-88e1d458.js","./TileInfoTilemapCache-0d76913b.js","./TilemapCache-d32eb7af.js","./SublayersOwner-bb15b743.js","./QueryTask-44320cc4.js","./executeForIds-5b595fba.js","./query-7fb34953.js","./pbfQueryUtils-06ca1a31.js","./pbf-20893484.js","./queryZScale-4260d97b.js","./executeQueryJSON-d5f14792.js","./FeatureSet-890fea54.js","./executeQueryPBF-fdbd0a42.js","./FeatureType-868607ca.js","./FeatureTemplate-d9befeeb.js","./LayerFloorInfo-ecc28037.js","./serviceCapabilitiesUtils-4d535ec8.js","./sublayerUtils-c6f9d89f.js","./imageBitmapUtils-e2807ce7.js"],import.meta.url)).default,UnknownLayer:async()=>(await t(()=>import("./UnknownLayer-a489ef3f.js"),["./UnknownLayer-a489ef3f.js","./index-35e234f2.js","./index-fa8fa232.css"],import.meta.url)).default,UnsupportedLayer:async()=>(await t(()=>import("./UnsupportedLayer-f7dd7eb3.js"),["./UnsupportedLayer-f7dd7eb3.js","./index-35e234f2.js","./index-fa8fa232.css"],import.meta.url)).default,VectorTileLayer:async()=>(await t(()=>import("./VectorTileLayer-dd83ad75.js"),["./VectorTileLayer-dd83ad75.js","./index-35e234f2.js","./index-fa8fa232.css","./APIKeyMixin-06dcd75c.js","./ArcGISCachedService-88e1d458.js","./TileInfoTilemapCache-0d76913b.js","./TilemapCache-d32eb7af.js","./jsonContext-666d664e.js","./StyleRepository-045437af.js","./TileClipper-ae6eca9e.js","./definitions-abc66d41.js"],import.meta.url)).default,VoxelLayer:async()=>(await t(()=>import("./VoxelLayer-61272df8.js"),["./VoxelLayer-61272df8.js","./index-35e234f2.js","./index-fa8fa232.css","./APIKeyMixin-06dcd75c.js","./SceneService-82f9501e.js","./I3SIndexInfo-0e348d7c.js","./persistable-ec035db7.js","./resourceExtension-f8a8d36e.js"],import.meta.url)).default,WFSLayer:async()=>(await t(()=>import("./WFSLayer-3ac364cb.js"),["./WFSLayer-3ac364cb.js","./index-35e234f2.js","./index-fa8fa232.css","./clientSideDefaults-068ef0e1.js","./QueryEngineCapabilities-85c4f1d0.js","./wfsUtils-a8b6a834.js","./geojson-6d7ec271.js","./date-430969b3.js","./xmlUtils-444cb4c0.js","./FeatureSet-890fea54.js","./OrderedLayer-c6a4e08e.js"],import.meta.url)).default,WMSLayer:async()=>(await t(()=>import("./WMSLayer-143b4870.js"),["./WMSLayer-143b4870.js","./index-35e234f2.js","./index-fa8fa232.css","./crsUtils-3bab3d8c.js","./ExportWMSImageParameters-e32cbaac.js","./imageBitmapUtils-e2807ce7.js"],import.meta.url)).default,WMTSLayer:async()=>(await t(()=>import("./WMTSLayer-5f587ee7.js"),["./WMTSLayer-5f587ee7.js","./index-35e234f2.js","./index-fa8fa232.css","./WebTileLayer-99295163.js","./imageBitmapUtils-e2807ce7.js","./TileInfoTilemapCache-0d76913b.js","./crsUtils-3bab3d8c.js","./xmlUtils-444cb4c0.js"],import.meta.url)).default,WebTileLayer:async()=>(await t(()=>import("./WebTileLayer-99295163.js").then(e=>e.W),["./WebTileLayer-99295163.js","./index-35e234f2.js","./index-fa8fa232.css","./imageBitmapUtils-e2807ce7.js"],import.meta.url)).default};async function S(e,i){const r=L(e);if(!r)throw new s("invalid-url","Invalid scene service url");const a={...i,sceneServerUrl:r.url.path,layerId:r.sublayer??void 0};if(a.sceneLayerItem??(a.sceneLayerItem=await A(a)),a.sceneLayerItem==null)return p(a.sceneServerUrl.replace("/SceneServer","/FeatureServer"),a);const o=await V(a);if(!o?.url)throw new s("related-service-not-found","Could not find feature service through portal item relationship");const _=await p(o.url,a);return _.portalItem=o,_}async function A(e){const i=(await E(e)).serviceItemId;if(!i)return null;const r=new f({id:i,apiKey:e.apiKey}),a=await O(e);a!=null&&(r.portal=new T({url:a}));try{return r.load({signal:e.signal})}catch(o){return m(o),null}}async function E(e){if(e.rootDocument)return e.rootDocument;const i={query:{f:"json",token:e.apiKey},responseType:"json",signal:e.signal};try{const r=await y(e.sceneServerUrl,i);e.rootDocument=r.data}catch{e.rootDocument={}}return e.rootDocument}async function O(e){const i=D?.findServerInfo(e.sceneServerUrl);if(i?.owningSystemUrl)return i.owningSystemUrl;const r=e.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const a=(await y(r,{query:{f:"json"},responseType:"json",signal:e.signal})).data.owningSystemUrl;if(a)return a}catch(a){m(a)}return null}async function p(e,i){const r=L(e);if(!r)throw new s("invalid-feature-service-url","Invalid feature service url");const a=r.url.path,o=i.layerId;if(o==null)return{serverUrl:a};const _=E(i),d=n=>{const I={query:{f:"json"},responseType:"json",authMode:n,signal:i.signal};return y(a,I)},v=d("anonymous").catch(()=>d("no-prompt")),[c,w]=await Promise.all([v,_]),l=w?.layers,u=c.data&&c.data.layers;if(!Array.isArray(u))throw new Error("expected layers array");if(Array.isArray(l)){for(let n=0;n<Math.min(l.length,u.length);n++)if(l[n].id===o)return{serverUrl:a,layerId:u[n].id}}else if(o!=null&&o<u.length)return{serverUrl:a,layerId:u[o].id};throw new Error("could not find matching associated sublayer")}async function V({sceneLayerItem:e,signal:i}){if(!e)return null;try{const r=(await e.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:i})).find(o=>o.type==="Feature Service")||null;if(!r)return null;const a=new f({portal:r.portal,id:r.id});return await a.load(),a}catch(r){return m(r),null}}export{R as a,S as l};
